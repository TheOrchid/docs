# Защитник
----------

Черный список и белый список

Все IP-адреса в этих списках не смогут получить доступ к маршрутам, фильтруемым фильтром черного списка.

`config/defender.php`

```php
/*
|--------------------------------------------------------------------------
| Black listed IP  addresses
|--------------------------------------------------------------------------
|
*/
'blacklist'  => [
    // '127.0.0.1',
],
/*
|--------------------------------------------------------------------------
| White listed IP addresses,
|--------------------------------------------------------------------------
|
*/
'whitelist'  => [
    // '127.0.0.2',
],
```

### Сканирование

Сканирование опасных файлов и функций в общедоступном каталоге в соответствии с сигнатурами, указанными в конфиге `config/defender`

По умолчанию проверяются файлы следующих типов:

```php
    /*
    |--------------------------------------------------------------------------
    | File extensions that will be scanned
    |--------------------------------------------------------------------------
    |
    */
    'extensions' => [
        '.ph',
        '.php',
        '.php3',
        '.phtml',
        '.htm',
        '.htm',
        '.html',
        '.txt',
        '.js',
        '.pl',
        '.cgi',
        '.py',
        '.bash',
        '.sh',
        '.xml',
        '.ssi',
        '.inc',
        '.pm',
        '.tpl',
    ],
```

А опасными функциями являются:

```php
    /*
    |--------------------------------------------------------------------------
    | Typical signs of malicious scripts
    |--------------------------------------------------------------------------
    |
    */
    'signatures' => [
        'exec',
        'passthru',
        'system',
        'shell_exec',
        'popen',
        'proc_open',
        'pcntl_exec',
        'eval',
        'base64',
        'base64_decode',
        'assert',
        'preg_replace',
        'create_function',
        'include',
        'include_once',
        'require',
        'require_once',
        'ReflectionFunction',
    ],
```

Для проверки необходимо выполнить
```php
php artisan defender:scan
```

